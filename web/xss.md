# XSS Methodology

# Manual approach

## Source and sink

- Sources
```
document.URL
document.documentURI
document.URLUnencoded (IE 5.5 or later Only)
document.baseURI
location
location.href
location.search
location.hash
location.pathname
document.cookie
document.referrer
window.name
history.pushState()
history.replaceState()
localStorage
sessionStorage
```

- Sinks
```
eval
Function
setTimeout
setInterval
setImmediate
execScript
crypto.generateCRMFRequest
ScriptElement.src
ScriptElement.text
ScriptElement.textContent
ScriptElement.innerText
anyTag.onEventName
document.write
document.writeln
anyElement.innerHTML
Range.createContextualFragment
window.location
document.location
```

- Q: How to identify sinks and sources?
- A: Use the browser extension [Untrusted Types](https://github.com/filedescriptor/untrusted-types) by filedescriptor.

# Automated approach

- Tools
  - Dalfox
  - XSStrike

# Useful resources
- XSS test beds
  - [Google's Firing Range](https://public-firing-range.appspot.com/)
- XSS services
  - [XSSHunter](https://xsshunter.com/)
- XSS weaponized payloads
  - [xss-payloads](http://www.xss-payloads.com/payloads-list.html?a#category=all)
  - [weaponized-xss-payloads](https://github.com/hakluke/weaponised-XSS-payloads)
