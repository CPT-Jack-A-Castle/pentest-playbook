# Man in the Middle Attack

The man-in-the-middle attack \(often abbreviated MITM, MitM, MIM, MiM, MITMA\) in cryptography and computer security is a form of active eavesdropping in which the attacker makes independent connections with the victims and relays messages between them, making them believe that they are talking directly to each other over a private connection, when in fact the entire conversation is controlled by the attacker.

## Scenario

This is the simple scenario, and I try to draw it in a picture.

Victim IP address : **192.168.8.90**

Attacker network interface : **eth0**; with IP address : **192.168.8.93**

Router IP address : **192.168.8.8**

* Requirements:
  * Arpspoof
  * Driftnet
  * Urlsnarf

## Man in the Middle Attack

* Open your terminal and configure the machine to allow packet forwarding, because act as man in the middle attacker, Kali Linux must act as router between "real router" and the victim.

```bash
sysctl net.ipv4.ip_forward=1
```

* The next step is setting up _arpspoof_ between victim and router.

```text
arpspoof -i eth0 -t 192.168.0.90 192.168.0.1
```

* And then setting up _arpspoof_ from to capture all packet from router to victim.

```text
arpspoof -i eth0 -t 192.168.0.1 192.168.0.90
```

* After step three and four, now all the packet sent or received by victim should be going through attacker machine.
* Now we can try to use driftnet to monitor all victim image traffic. According to its website,

> Driftnet is a program which listens to network traffic and picks out images from TCP streams it observes. Fun to run on a host which sees lots of web traffic.

* To run driftnet, we just run `driftnet -i eth0` 
* When victim browse a website with image, driftnet will capture all image traffic as shown in the screenshot below.

For the next step we will try to capture the website information/data by using _urlsnarf_. To use _urlsnarf_, just run this code `urlsnarf -i eth0` and _urlsnarf_ will start capturing all website address visited by victim machine. When victim browse a website, attacker will know the address victim visited.

